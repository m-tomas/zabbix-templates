zabbix_export:
  version: '7.2'
  template_groups:
    - uuid: 57b7ae836ca64446ba2c296389c009b7
      name: Templates/Modules
  templates:
    - uuid: 32cb5e0c06c04af48d6bf9120af1e008
      template: 'Generic SNMP module by SNMP'
      name: 'Generic SNMP module by SNMP'
      description: 'Based on official Generic by SNMP template.'
      vendor:
        name: m-tomas
        version: 7.2-0
      groups:
        - name: Templates/Modules
      items:
        - uuid: aa18337a9b0f4801ad8cd406bacf54c5
          name: 'ICMP ping'
          type: SIMPLE
          key: icmpping
          description: |
            Host accessibility by ICMP.
            0 - ICMP ping failed.
            1 - ICMP ping successful.
          valuemap:
            name: 'Service state'
          tags:
            - tag: application
              value: status
          triggers:
            - uuid: f0da7f38970e4cd1bd514ddb889624a4
              expression: 'max(/Generic SNMP module by SNMP/icmpping,#3)=0 or nodata(/Generic SNMP module by SNMP/icmpping,{$PING.TIMEOUT})=1'
              name: 'Unavailable by ICMP ping'
              priority: HIGH
              description: 'Last three attempts returned timeout.  Please check device connectivity.'
        - uuid: a89d3bd67df94c03943f1a1735525648
          name: 'ICMP loss'
          type: SIMPLE
          key: icmppingloss
          value_type: FLOAT
          units: '%'
          description: 'Percentage of lost packets.'
          tags:
            - tag: application
              value: status
          triggers:
            - uuid: 4c72d4d535434515b0d123cd9ffbf111
              expression: 'min(/Generic SNMP module by SNMP/icmppingloss,5m)>{$ICMP.LOSS.HIGH} and min(/Generic SNMP module by SNMP/icmppingloss,5m)<100'
              name: 'High ICMP ping loss'
              opdata: 'Loss: {ITEM.LASTVALUE}'
              priority: WARNING
              description: 'ICMP ping loss detected.'
              dependencies:
                - name: 'Unavailable by ICMP ping'
                  expression: 'max(/Generic SNMP module by SNMP/icmpping,#3)=0 or nodata(/Generic SNMP module by SNMP/icmpping,{$PING.TIMEOUT})=1'
        - uuid: a52905f0d2bd4ac6ab687bc8e1ff303d
          name: 'ICMP response time'
          type: SIMPLE
          key: icmppingsec
          value_type: FLOAT
          units: s
          description: 'ICMP ping response time (in seconds).'
          tags:
            - tag: application
              value: status
          triggers:
            - uuid: f4eaa5b85fee4f6d83b681719c1f0193
              expression: 'avg(/Generic SNMP module by SNMP/icmppingsec,5m)>{$ICMP.RESPONSE.TIME.HIGH}'
              name: 'High ICMP ping response time'
              opdata: 'Value: {ITEM.LASTVALUE}'
              priority: WARNING
              description: 'Average ICMP response time is too high.'
              dependencies:
                - name: 'High ICMP ping loss'
                  expression: 'min(/Generic SNMP module by SNMP/icmppingloss,5m)>{$ICMP.LOSS.HIGH} and min(/Generic SNMP module by SNMP/icmppingloss,5m)<100'
                - name: 'Unavailable by ICMP ping'
                  expression: 'max(/Generic SNMP module by SNMP/icmpping,#3)=0 or nodata(/Generic SNMP module by SNMP/icmpping,{$PING.TIMEOUT})=1'
        - uuid: 774e36f4c1d049cc9964c9bc0d3ef610
          name: 'SNMP traps (fallback)'
          type: SNMP_TRAP
          key: snmptrap.fallback
          value_type: LOG
          description: 'Used for collecting all SNMP traps unmatched by other `snmptrap` items.'
          logtimefmt: 'hh:mm:sszyyyy/MM/dd'
          tags:
            - tag: application
              value: other
        - uuid: 4631dd29c31544f8994c3c87d302a93b
          name: 'System contact details'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.4.0]'
          key: system.contact.details
          delay: 8h
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            The textual identification of the contact person for this managed node, together with information on how to contact this person.  If no contact information is known, the value is the zero-length string.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: system
        - uuid: 3b9c6739bbbb43979e890a1e6b87feb7
          name: 'System description'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.1.0]'
          key: system.description
          delay: 8h
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            A textual description of the entity. This value should
            include the full name and version identification of the system's hardware type, software operating-system, and
            networking software.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: system
        - uuid: 14c875579e9b4aa78556f55d2512d5f4
          name: 'Uptime (hardware)'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.25.1.1.0]'
          key: system.hw.uptime
          trends: '0'
          units: uptime
          description: |
            MIB: HOST-RESOURCES-MIB
            The amount of time since this host was last initialized. Note that this is different from sysUpTime in the SNMPv2-MIB [RFC1907] because sysUpTime is the uptime of the network management portion of the system.
          preprocessing:
            - type: CHECK_NOT_SUPPORTED
              parameters:
                - '-1'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: application
              value: status
        - uuid: 9250b3d7f657407f9c1837a1d52b0767
          name: 'System location'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.6.0]'
          key: system.location
          delay: 8h
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            The physical location of this node (e.g., `telephone closet, 3rd floor').  If the location is unknown, the value is the zero-length string.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: system
        - uuid: 8efeb1aa05614861b9fd518ee1daeb6b
          name: 'System name'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.5.0]'
          key: system.name
          delay: 8h
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            An administratively-assigned name for this managed node.By convention, this is the node's fully-qualified domain name.  If the name is unknown, the value is the zero-length string.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: 0622a97e6a734521bd6326534a9ef2c4
              expression: 'change(/Generic SNMP module by SNMP/system.name)=1 and length(last(/Generic SNMP module by SNMP/system.name))>0'
              name: 'System name has changed'
              opdata: 'New name: {ITEM.LASTVALUE}'
              priority: INFO
              description: 'The name of the system has changed. Acknowledge to close the problem manually.'
              manual_close: 'YES'
        - uuid: d64307f8a7d843fe9686e98e38e95e3c
          name: 'Uptime (network)'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.3.0]'
          key: system.net.uptime
          trends: '0'
          units: uptime
          description: |
            MIB: SNMPv2-MIB
            Time (in hundredths of a second) since the network management portion of the system was last re-initialized.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: application
              value: status
        - uuid: e498efba07934042b19a475859ccebb1
          name: 'SNMP agent availability'
          type: INTERNAL
          key: 'zabbix[host,snmp,available]'
          description: |
            Availability of SNMP checks on the host. The value of this item corresponds to availability icons in the host list.
            Possible value:
            0 - not available
            1 - available
            2 - unknown
          valuemap:
            name: 'Host availability status'
          tags:
            - tag: application
              value: status
          triggers:
            - uuid: 8832548d7f634661845986333a162efb
              expression: 'max(/Generic SNMP module by SNMP/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
              name: 'No SNMP data collection'
              opdata: 'Current state: {ITEM.LASTVALUE}'
              priority: HIGH
              description: 'SNMP is not available for polling. Please check device connectivity and SNMP settings.'
              dependencies:
                - name: 'Unavailable by ICMP ping'
                  expression: 'max(/Generic SNMP module by SNMP/icmpping,#3)=0 or nodata(/Generic SNMP module by SNMP/icmpping,{$PING.TIMEOUT})=1'
      macros:
        - macro: '{$ICMP.LOSS.HIGH}'
          value: '20'
          description: 'Threshold for high ICMP packet loss trigger in %.'
        - macro: '{$ICMP.RESPONSE.TIME.HIGH}'
          value: '0.15'
          description: 'Threshold for high average ICMP response time trigger in seconds.'
        - macro: '{$PING.TIMEOUT}'
          value: 5m
          description: 'The time interval for ICMP availability trigger.'
        - macro: '{$SNMP.TIMEOUT}'
          value: 5m
          description: 'The time interval for SNMP availability trigger.'
      valuemaps:
        - uuid: 6f861170249040be9bc482c56a3c8a11
          name: 'Host availability status'
          mappings:
            - value: '0'
              newvalue: 'not available'
            - value: '1'
              newvalue: available
            - value: '2'
              newvalue: unknown
        - uuid: 73baad14b8574892b20090416ffd1606
          name: 'Service state'
          mappings:
            - value: '0'
              newvalue: down
            - value: '1'
              newvalue: up
  triggers:
    - uuid: c2ccf6cdc1d34e13af960762088c2f34
      expression: '(last(/Generic SNMP module by SNMP/system.hw.uptime)>0 and last(/Generic SNMP module by SNMP/system.hw.uptime)<10m) or (last(/Generic SNMP module by SNMP/system.hw.uptime)=0 and last(/Generic SNMP module by SNMP/system.net.uptime)<10m)'
      name: 'Device has been restarted'
      priority: AVERAGE
      description: 'Uptime is less than 10 minutes.'
      dependencies:
        - name: 'No SNMP data collection'
          expression: 'max(/Generic SNMP module by SNMP/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
